<html>
<head>
    <meta charset="UTF-8">
    <title>MelodyCampusMainPage</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="css/common.css">

    <!-- 引入 jquery -->
    <script src="js/jquery.min.js"></script>
    <script src="js/MusicSquare.js"> </script>
    <script src="js/MyFavorite.js"> </script>
    <script src="js/MySong.js"> </script>

</head>

<style>
    /* 设置表格容器的外边距为自动，宽度为80% */
    .content-table { margin: auto; width: 80%; }

    /* 设置操作按钮容器的样式 */
    .action-buttons {
        display: flex; /* 使用flex布局 */
        justify-content: flex-end; /* 将按钮靠右对齐 */
        gap: 10px; /* 设置按钮之间的间距 */
        position: absolute; /* 使用绝对定位 */
        right: calc((100% - 80%) / 2); /* 将容器右侧与表格右侧对齐 */
        top: 300px; /* 设置容器距顶部的距离 */
        align-items: center; /* 垂直居中对齐 */
    }

    /* 设置歌手输入框的样式 */
    .singer-input {
        width: 150px; /* 设置输入框宽度 */
        margin-right: 10px; /* 与上传按钮之间的间距 */
    }

    /* 设置顶部右侧按钮的样式 */
    .search-bar .btn, .top-right-buttons .btn {
        padding: 8px 16px; /* 设置内边距 */
        border-radius: 20px; /* 设置圆角 */
        background: linear-gradient(45deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.1)); /* 设置渐变背景 */
        color: #fff; /* 设置文字颜色 */
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); /* 设置阴影效果 */
        transition: all 0.3s ease; /* 设置过渡效果 */
    }

    /* 设置顶部右侧按钮的悬停效果 */
    .search-bar .btn:hover, .top-right-buttons .btn:hover {
        background: linear-gradient(45deg, rgba(255, 255, 255, 0.3), rgba(255, 255, 255, 0.2)); /* 设置悬停时的渐变背景 */
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); /* 设置悬停时的阴影效果 */
        transform: translateY(-2px); /* 设置悬停时的上下位移 */
    }

    /* 设置顶部右侧按钮中图标的样式 */
    .top-right-buttons .btn i {
        margin-right: 8px; /* 设置图标与文字之间的间距 */
    }

    /* 设置操作按钮的样式 */
    .action-buttons .btn {
        padding: 8px 16px; /* 设置内边距 */
        border-radius: 20px; /* 设置圆角 */
        background: linear-gradient(45deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.1)); /* 设置渐变背景 */
        color: #fff; /* 设置文字颜色 */
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        transition: all 0.3s ease;
    }

    .action-buttons .btn:hover {
        background: linear-gradient(45deg, rgba(255, 255, 255, 0.3), rgba(255, 255, 255, 0.2));
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        transform: translateY(-2px);
    }

    .upload-btn {
        padding: 6px 12px; /* 调整上传按钮的内边距 */
        border-radius: 4px; /* 添加一些圆角 */
        transition: background-color 0.3s ease; /* 添加过渡效果 */
    }

    .upload-btn:hover {
        background-color: #6c757d; /* 鼠标悬停时的背景颜色 */
        color: #fff; /* 鼠标悬停时的文字颜色 */
    }

    .table thead th {
        background-color: #e9ecef;
    }
    .table tbody tr {
        background-color: white;
    }
    .table tbody tr:nth-of-type(even) {
        background-color: #f8f9fa;
    }
    .table tbody td {
        vertical-align: middle;
    }
    .btn-group {
        display: flex;
        gap: 5px;
    }

    .search-bar {
        padding: 20px 0;
        display: flex;
        justify-content: flex-start;
        gap: 10px;
        margin-left: calc((100% - 80%) / 2); /* Align with the left edge of the list */
    }
    .search-input {
        width: 200px;
    }
    .action-buttons {
        display: flex;
        justify-content: flex-end;
        gap: 10px;
        position: absolute;
        right: calc((100% - 80%) / 2); /* Align with the right edge of the list */
        top: 295px; /* Align vertically with the query box */
    }
    .carousel-container {
        width: 100%;
        display: flex;
        justify-content: center;
    }
    .carousel {
        width: 50%;
    }
    .carousel img {
        height: 200px; /* Reduce the height of the carousel images by half */
        object-fit: cover; /* Ensure the images cover the carousel area without stretching */
    }

    .top-right-buttons {
        position: absolute;
        right: 40px; /* Align with the right edge of the list */
        top: 20px; /* Position at the top right */
        display: flex;
        gap: 10px;
    }

    .btn-outline-primary .fa-heart {
        color: red; /* 喜欢列表颜色 */
    }

    .liked {
        color: red; /*歌曲被收藏的颜色*/
    }

    /*点击右上角按钮后的效果*/
    .clicked {
        transform: translateY(-2px);
        background: linear-gradient(45deg, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.5)) !important; /* 加深渐变背景 */
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5) !important; /* 加深阴影效果 */
    }
</style>

<body>
<!-- 导航栏 -->
<div class="nav">
    <img src="img/logo.jpg"  alt="MelodyCampus logo" class="logo">

    <span class="title">MelodyCampus</span>
    <span class="spacer"></span>
</div>

<!-- 顶部右侧按钮 -->
<div class="top-right-buttons">
    <button class="btn btn-outline-success"><i class="fas fa-square"></i> 音乐广场</button>
    <button class="btn btn-outline-primary"><i class="fas fa-heart"></i> 喜欢列表</button>
    <button class="btn btn-outline-secondary"><i class="fas fa-music"></i> 我的歌曲</button>
    <!-- 新增注销按钮 -->
    <a href="login.html" class="btn btn-outline-danger"><i class="fas fa-sign-out-alt"></i> 注销</a>
</div>

<!-- 轮播图位置 -->
<div class="carousel-container">
    <div id="carouselExampleIndicators" class="carousel slide carousel" data-bs-ride="carousel">
        <div class="carousel-inner">
            <div class="carousel-item active">

            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
</div>

<div class="search-bar">
    <input type="text" class="form-control search-input" placeholder="请输入歌名">
    <button class="btn btn-primary">查询</button>
</div>

<div class="action-buttons">
    <!--<button class="btn btn-outline-primary"><i class="fas fa-heart"></i> 喜欢列表</button>-->
    <input class="btn btn-outline-secondary upload-btn" type="file">
    <input type="text" class="form-control singer-input" placeholder="请输入歌手名称">
    <button class="btn btn-primary submit-btn" >上传</button>

    <button class="btn btn-outline-danger"><i class="fas fa-trash-alt"></i> 删除选中</button>
</div>
<table class="table content-table">
    <thead>
    <tr>
        <th>选择</th>
        <th>歌名</th>
        <th>歌手</th>
        <th>歌曲</th>
        <th>操作</th>
    </tr>
    </thead>
    <tbody id="musicList">
    <!--从数据库中获取所有歌曲信息-->
    </tbody>
</table>

<!--歌曲播放组件-->
<iframe src="player.html" id="musicPlayer" style="height: 100px; width: 100%; border: none;">

</iframe>

</body>

<script>
    /*页面加载完成时调用loadMusic()*/
    $(function() {
         loadMusic();

        $(".search-bar .btn-primary").off('click');
        // 然后为它绑定一个新的click事件处理程序
        $(".search-bar .btn-primary").on('click', selectByMusicName);
        $(".top-right-buttons .btn-outline-success").addClass("clicked");

        // 隐藏删除选中音乐按钮
        $(".action-buttons .btn-outline-danger").hide();

    });

    // 为按钮设置点击事件监听器
    $(function() {
        /*音乐广场*/
        $(".top-right-buttons .btn-outline-success, .logo").click(function() {
            loadMusic();
            $(".search-bar .btn-primary").off('click');
            // 然后为它绑定一个新的click事件处理程序
            $(".search-bar .btn-primary").on('click', selectByMusicName);

            // 显示上传音乐按钮
            $(".action-buttons .upload-btn, .action-buttons .singer-input, .action-buttons .submit-btn").show();

            // 隐藏删除选中音乐按钮
            $(".action-buttons .btn-outline-danger").hide();
        });

        /*喜欢列表*/
        $(".top-right-buttons .btn-outline-primary").click(function() {
            loadLoveMusic();
            $(".search-bar .btn-primary").off('click');
            // 绑定一个新的click事件处理程序
            $(".search-bar .btn-primary").on('click', selectMyLoveByMusicName);

            // 隐藏上传音乐按钮
            $(".action-buttons .upload-btn, .action-buttons .singer-input, .action-buttons .submit-btn").hide();

            // 隐藏删除选中音乐按钮
            $(".action-buttons .btn-outline-danger").hide();
        });

        /*我的歌曲*/
        $(".top-right-buttons .btn-outline-secondary").click(function() {
            loadMyMusic();
            $(".search-bar .btn-primary").off('click');
            // 然后为它绑定一个新的click事件处理程序
            $(".search-bar .btn-primary").on('click', selectMySongByMusicName);

            // 隐藏上传音乐按钮
            $(".action-buttons .upload-btn, .action-buttons .singer-input, .action-buttons .submit-btn").hide();

            // 显示删除选中音乐按钮
            $(".action-buttons .btn-outline-danger").show();
        });
    });

    /*点击右上角按钮后的效果*/
    $(function() {
        // 当这三个按钮中的任何一个被点击时
        $(".top-right-buttons .btn-outline-success, .top-right-buttons .btn-outline-primary, .top-right-buttons .btn-outline-secondary").click(function() {
            // 首先，移除所有按钮上的.clicked类
            $(".top-right-buttons .btn-outline-success, .top-right-buttons .btn-outline-primary, .top-right-buttons .btn-outline-secondary").removeClass("clicked");

            // 清除查詢框
            $(".search-bar .search-input").val("");

            // 然后，给当前被点击的按钮添加.clicked类
            $(this).addClass("clicked");
        });
    });

    /* 获取轮播图*/
        $(function() {
        $.ajax({
            url: '/api/carousel',
            method: 'GET',
            success: function(carouselData) {
                const $carouselInner = $('.carousel-inner');

                $.each(carouselData, (index, item) => {
                    const $carouselItem = $('<div>', {
                        class: 'carousel-item',
                    });

                    const $img = $('<img>', {
                        class: 'd-block w-100',
                        src: item.imagePath,
                        alt: item.id,
                    });

                    const $link = $('<a>', {
                        href: item.targetWebsiteLink || item.imageLink,
                        target: '_blank',
                    });
                    $link.append($img);
                    $carouselItem.append($link);

                    const $eventName = $('<h3>', {
                        class: 'event-name',
                        text: item.eventName,
                    });
                    $carouselItem.append($eventName);

                    $carouselInner.append($carouselItem);

                    if (index === 0) {
                        $carouselItem.addClass('active');
                    }
                });
            },
            error: function(xhr, status, error) {
                console.error('Error fetching carousel data:', error);
            }
        })
    });
</script>
</script>


</script>

</html>